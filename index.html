<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Speed Monitor</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn-primary {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
        }

        .btn-info {
            background: linear-gradient(45deg, #FF9800, #F57C00);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(45deg, #9C27B0, #7B1FA2);
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, #673AB7, #5E35B1);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            color: white;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h3 {
            color: #666;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .speed-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .connection-type, .speed-status {
            font-size: 0.9em;
            padding: 5px 10px;
            border-radius: 15px;
            display: inline-block;
        }

        .connection-type {
            background: #e3f2fd;
            color: #1976D2;
        }

        .speed-status {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        /* Devices Table Section */
        .devices-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .section-header h2 {
            color: #333;
            font-size: 1.5em;
        }

        .table-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .device-count {
            background: #e3f2fd;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            color: #1976D2;
        }

        .table-wrapper {
            overflow-x: auto;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }

        .devices-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }

        .devices-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9em;
            cursor: pointer;
            user-select: none;
            position: relative;
        }

        .devices-table th:hover {
            background: linear-gradient(135deg, #5a6fd8, #6a4190);
        }

        .devices-table th::after {
            content: '‚Üï';
            margin-left: 5px;
            opacity: 0.7;
        }

        .devices-table th.sorted-asc::after {
            content: '‚Üë';
        }

        .devices-table th.sorted-desc::after {
            content: '‚Üì';
        }

        .devices-table td {
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 0.9em;
        }

        .devices-table tbody tr {
            transition: background-color 0.2s ease;
        }

        .devices-table tbody tr:hover {
            background-color: #f8f9fa;
        }

        .devices-table tbody tr:nth-child(even) {
            background-color: #fafafa;
        }

        .devices-table tbody tr:nth-child(even):hover {
            background-color: #f1f3f4;
        }

        .no-devices {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 40px;
        }

        /* Status badges */
        .status-online {
            background: #4CAF50;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .status-offline {
            background: #f44336;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .status-unknown {
            background: #FF9800;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
        }

        /* Device type colors */
        .mac-address {
            font-family: 'Courier New', monospace;
            background: #f1f3f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.85em;
        }

        .type-computer {
            border-left: 4px solid #4CAF50;
        }

        .type-phone {
            border-left: 4px solid #2196F3;
        }

        .type-router {
            border-left: 4px solid #FF9800;
        }

        .type-tablet {
            border-left: 4px solid #9C27B0;
        }

        .type-iot {
            border-left: 4px solid #607D8B;
        }

        .type-printer {
            border-left: 4px solid #795548;
        }

        .type-unknown {
            border-left: 4px solid #9E9E9E;
        }

        .charts {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .log-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .log {
            height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 10px;
            background: #fafafa;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 5px;
            border-left: 3px solid #4CAF50;
            background: white;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .charts {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .section-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .table-controls {
                width: 100%;
                justify-content: space-between;
            }
            
            .devices-table {
                font-size: 0.8em;
            }
            
            .devices-table th,
            .devices-table td {
                padding: 8px 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ Network Speed Monitor</h1>
            <p>Monitor local network speed and connected devices</p>
        </header>

        <div class="controls">
            <button id="startMonitor" class="btn btn-primary">Start Monitoring</button>
            <button id="speedTest" class="btn btn-secondary">Internet Speed Test</button>
            <button id="scanNetwork" class="btn btn-info">Scan Network</button>
            <button id="detectConnection" class="btn btn-warning">Detect Connection Type</button>
            <button id="exportDevices" class="btn btn-success">Export to CSV</button>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <h3>Local Speed</h3>
                <div id="localSpeed" class="speed-value">0 Mbps</div>
                <div id="connectionType" class="connection-type">-</div>
            </div>
            
            <div class="stat-card">
                <h3>Download</h3>
                <div id="downloadSpeed" class="speed-value">0 Mbps</div>
                <div class="speed-status" id="downloadStatus">-</div>
            </div>
            
            <div class="stat-card">
                <h3>Upload</h3>
                <div id="uploadSpeed" class="speed-value">0 Mbps</div>
                <div class="speed-status" id="uploadStatus">-</div>
            </div>
            
            <div class="stat-card">
                <h3>Ping</h3>
                <div id="pingValue" class="speed-value">0 ms</div>
                <div class="speed-status" id="pingStatus">-</div>
            </div>
        </div>

        <!-- Network Devices Table Section -->
        <div class="devices-container">
            <div class="section-header">
                <h2>üåê Connected Devices</h2>
                <div class="table-controls">
                    <button id="refreshDevices" class="btn btn-small">Refresh Scan</button>
                    <span class="device-count" id="deviceCount">0 devices found</span>
                </div>
            </div>
            
            <div class="table-wrapper">
                <table id="devicesTable" class="devices-table">
                    <thead>
                        <tr>
                            <th data-sort="hostname">Hostname</th>
                            <th data-sort="ip">IP Address</th>
                            <th data-sort="mac">MAC Address</th>
                            <th data-sort="type">Device Type</th>
                            <th data-sort="manufacturer">Manufacturer</th>
                            <th data-sort="os">OS/System</th>
                            <th data-sort="responseTime">Response Time</th>
                            <th data-sort="lastSeen">Last Seen</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="devicesTableBody">
                        <tr>
                            <td colspan="9" class="no-devices">No devices found. Click "Scan Network" to discover devices.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="charts">
            <div class="chart-container">
                <canvas id="speedChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="comparisonChart"></canvas>
            </div>
        </div>

        <div class="log-container">
            <h3>Activity Log</h3>
            <div id="log" class="log"></div>
        </div>
    </div>

    <script>
        class NetworkMonitor {
            constructor() {
                this.isMonitoring = false;
                this.monitorInterval = null;
                this.speedData = {
                    labels: [],
                    local: [],
                    download: [],
                    upload: [],
                    ping: []
                };
                
                this.discoveredDevices = [];
                this.currentSort = { field: 'hostname', direction: 'asc' };
                
                this.initializeCharts();
                this.setupEventListeners();
            }

            initializeCharts() {
                // Main speed chart
                const speedCtx = document.getElementById('speedChart').getContext('2d');
                this.speedChart = new Chart(speedCtx, {
                    type: 'line',
                    data: {
                        labels: this.speedData.labels,
                        datasets: [
                            {
                                label: 'Local Speed (Mbps)',
                                data: this.speedData.local,
                                borderColor: '#4CAF50',
                                backgroundColor: 'rgba(76, 175, 80, 0.1)',
                                tension: 0.4,
                                fill: true
                            },
                            {
                                label: 'Download (Mbps)',
                                data: this.speedData.download,
                                borderColor: '#2196F3',
                                backgroundColor: 'rgba(33, 150, 243, 0.1)',
                                tension: 0.4,
                                fill: true
                            },
                            {
                                label: 'Upload (Mbps)',
                                data: this.speedData.upload,
                                borderColor: '#FF9800',
                                backgroundColor: 'rgba(255, 152, 0, 0.1)',
                                tension: 0.4,
                                fill: true
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Network Speed - Live Monitoring'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Mbps'
                                }
                            }
                        }
                    }
                });

                // Comparison chart
                const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
                this.comparisonChart = new Chart(comparisonCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Local', 'Download', 'Upload'],
                        datasets: [{
                            label: 'Current Speeds (Mbps)',
                            data: [0, 0, 0],
                            backgroundColor: [
                                '#4CAF50',
                                '#2196F3',
                                '#FF9800'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Speed Comparison'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            setupEventListeners() {
                document.getElementById('startMonitor').addEventListener('click', () => {
                    this.toggleMonitoring();
                });

                document.getElementById('speedTest').addEventListener('click', () => {
                    this.runSpeedTest();
                });

                document.getElementById('scanNetwork').addEventListener('click', () => {
                    this.scanNetwork();
                });

                document.getElementById('detectConnection').addEventListener('click', () => {
                    this.detectConnectionType();
                });

                document.getElementById('refreshDevices').addEventListener('click', () => {
                    this.scanNetwork();
                });

                document.getElementById('exportDevices').addEventListener('click', () => {
                    this.exportToCSV();
                });

                // Table sorting
                document.querySelectorAll('#devicesTable th[data-sort]').forEach(th => {
                    th.addEventListener('click', () => {
                        this.sortTable(th.dataset.sort);
                    });
                });
            }

            toggleMonitoring() {
                if (this.isMonitoring) {
                    this.stopMonitoring();
                } else {
                    this.startMonitoring();
                }
            }

            startMonitoring() {
                this.isMonitoring = true;
                document.getElementById('startMonitor').textContent = 'Stop Monitoring';
                document.getElementById('startMonitor').classList.add('btn-danger');
                
                this.log('Live monitoring started...');
                
                this.monitorInterval = setInterval(() => {
                    this.updateLocalSpeed();
                    this.updateCharts();
                }, 3000);
            }

            stopMonitoring() {
                this.isMonitoring = false;
                document.getElementById('startMonitor').textContent = 'Start Monitoring';
                document.getElementById('startMonitor').classList.remove('btn-danger');
                
                this.log('Monitoring stopped');
                
                if (this.monitorInterval) {
                    clearInterval(this.monitorInterval);
                }
            }

            async updateLocalSpeed() {
                try {
                    // Simulate local speed measurement
                    const localSpeed = Math.random() * 1000;
                    const timestamp = new Date().toLocaleTimeString();
                    
                    document.getElementById('localSpeed').textContent = localSpeed.toFixed(2) + ' Mbps';
                    
                    // Update chart data
                    this.speedData.labels.push(timestamp);
                    this.speedData.local.push(localSpeed);
                    
                    // Keep only last 20 data points
                    if (this.speedData.labels.length > 20) {
                        this.speedData.labels.shift();
                        this.speedData.local.shift();
                        this.speedData.download.shift();
                        this.speedData.upload.shift();
                        this.speedData.ping.shift();
                    }
                    
                } catch (error) {
                    this.log('Error measuring local speed: ' + error.message);
                }
            }

            async scanNetwork() {
                try {
                    this.log('Scanning network for devices...');
                    
                    // Show loading state
                    document.getElementById('devicesTableBody').innerHTML = '<tr><td colspan="9" class="no-devices">Scanning network... Please wait.</td></tr>';
                    
                    const devices = await this.performNetworkScan();
                    this.discoveredDevices = devices;
                    
                    this.displayDevicesTable(devices);
                    this.updateDeviceCount(devices.length);
                    this.log('Found ' + devices.length + ' devices on the network');
                    
                } catch (error) {
                    this.log('Network scan failed: ' + error.message);
                    document.getElementById('devicesTableBody').innerHTML = '<tr><td colspan="9" class="no-devices">Scan failed. Please try again.</td></tr>';
                }
            }

            async performNetworkScan() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const deviceTypes = ['computer', 'phone', 'router', 'tablet', 'iot', 'printer'];
                        const manufacturers = ['Apple', 'Samsung', 'Dell', 'HP', 'TP-Link', 'Netgear', 'Cisco', 'Asus'];
                        const osTypes = ['Windows 11', 'macOS', 'Linux', 'iOS', 'Android', 'RouterOS'];
                        
                        const devices = [];
                        const deviceCount = Math.floor(Math.random() * 15) + 8;
                        
                        for (let i = 0; i < deviceCount; i++) {
                            const deviceType = deviceTypes[Math.floor(Math.random() * deviceTypes.length)];
                            const manufacturer = manufacturers[Math.floor(Math.random() * manufacturers.length)];
                            const os = osTypes[Math.floor(Math.random() * osTypes.length)];
                            const isOnline = Math.random() > 0.1;
                            
                            devices.push({
                                ip: '192.168.1.' + (Math.floor(Math.random() * 254) + 1),
                                mac: this.generateRandomMAC(),
                                hostname: this.generateHostname(manufacturer, deviceType),
                                manufacturer: manufacturer,
                                type: deviceType,
                                os: os,
                                responseTime: Math.floor(Math.random() * 100) + 1,
                                lastSeen: new Date(),
                                status: isOnline ? 'online' : 'offline'
                            });
                        }
                        
                        // Add router/gateway
                        devices.push({
                            ip: '192.168.1.1',
                            mac: this.generateRandomMAC(),
                            hostname: 'router.local',
                            manufacturer: 'TP-Link',
                            type: 'router',
                            os: 'RouterOS',
                            responseTime: 1,
                            lastSeen: new Date(),
                            status: 'online'
                        });
                        
                        resolve(devices);
                    }, 2000);
                });
            }

            generateRandomMAC() {
                const hex = '0123456789ABCDEF';
                let mac = '';
                for (let i = 0; i < 6; i++) {
                    mac += hex[Math.floor(Math.random() * 16)];
                    mac += hex[Math.floor(Math.random() * 16)];
                    if (i < 5) mac += ':';
                }
                return mac;
            }

            generateHostname(manufacturer, type) {
                const suffixes = {
                    computer: ['PC', 'Laptop', 'Workstation', 'Desktop'],
                    phone: ['Phone', 'Mobile', 'Smartphone'],
                    router: ['Router', 'Gateway', 'Access-Point'],
                    tablet: ['Tablet', 'Pad'],
                    iot: ['Smart-TV', 'Camera', 'Speaker', 'Thermostat'],
                    printer: ['Printer', 'Multifunction']
                };
                
                const suffix = suffixes[type][Math.floor(Math.random() * suffixes[type].length)];
                const randomNum = Math.floor(Math.random() * 100);
                return manufacturer + '-' + suffix + '-' + randomNum;
            }

            displayDevicesTable(devices) {
                const tbody = document.getElementById('devicesTableBody');
                
                if (devices.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="9" class="no-devices">No devices found on the network.</td></tr>';
                    return;
                }
                
                const sortedDevices = this.sortDevices(devices, this.currentSort.field, this.currentSort.direction);
                
                tbody.innerHTML = sortedDevices.map(device => {
                    return '<tr class="type-' + device.type + '">' +
                           '<td><strong>' + device.hostname + '</strong></td>' +
                           '<td>' + device.ip + '</td>' +
                           '<td><span class="mac-address">' + device.mac + '</span></td>' +
                           '<td>' + this.capitalizeFirstLetter(device.type) + '</td>' +
                           '<td>' + device.manufacturer + '</td>' +
                           '<td>' + device.os + '</td>' +
                           '<td>' + device.responseTime + ' ms</td>' +
                           '<td>' + device.lastSeen.toLocaleTimeString() + '</td>' +
                           '<td><span class="status-' + device.status + '">' + device.status.toUpperCase() + '</span></td>' +
                           '</tr>';
                }).join('');
            }

            sortTable(field) {
                if (this.currentSort.field === field) {
                    this.currentSort.direction = this.currentSort.direction === 'asc' ? 'desc' : 'asc';
                } else {
                    this.currentSort.field = field;
                    this.currentSort.direction = 'asc';
                }
                
                document.querySelectorAll('#devicesTable th').forEach(th => {
                    th.classList.remove('sorted-asc', 'sorted-desc');
                });
                
                const currentTh = document.querySelector('#devicesTable th[data-sort="' + field + '"]');
                currentTh.classList.add('sorted-' + this.currentSort.direction);
                
                this.displayDevicesTable(this.discoveredDevices);
            }

            sortDevices(devices, field, direction) {
                return [...devices].sort((a, b) => {
                    let aValue = a[field];
                    let bValue = b[field];
                    
                    if (field === 'responseTime') {
                        aValue = parseInt(aValue);
                        bValue = parseInt(bValue);
                    }
                    
                    if (field === 'lastSeen') {
                        aValue = new Date(aValue);
                        bValue = new Date(bValue);
                    }
                    
                    if (aValue < bValue) return direction === 'asc' ? -1 : 1;
                    if (aValue > bValue) return direction === 'asc' ? 1 : -1;
                    return 0;
                });
            }

            updateDeviceCount(count) {
                document.getElementById('deviceCount').textContent = count + ' device' + (count !== 1 ? 's' : '') + ' found';
            }

            exportToCSV() {
                if (this.discoveredDevices.length === 0) {
                    this.log('No devices to export');
                    return;
                }

                const headers = ['Hostname', 'IP Address', 'MAC Address', 'Device Type', 'Manufacturer', 'OS/System', 'Response Time (ms)', 'Last Seen', 'Status'];
                const csvData = [
                    headers.join(','),
                    ...this.discoveredDevices.map(device => [
                        device.hostname,
                        device.ip,
                        device.mac,
                        device.type,
                        device.manufacturer,
                        device.os,
                        device.responseTime,
                        device.lastSeen.toLocaleString(),
                        device.status
                    ].join(','))
                ].join('\n');

                const blob = new Blob([csvData], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'network-devices-' + new Date().toISOString().split('T')[0] + '.csv';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);

                this.log('Devices exported to CSV file');
            }

            async runSpeedTest() {
                try {
                    this.log('Running internet speed test...');
                    
                    const speedTest = await this.performSpeedTest();
                    
                    document.getElementById('downloadSpeed').textContent = speedTest.download + ' Mbps';
                    document.getElementById('uploadSpeed').textContent = speedTest.upload + ' Mbps';
                    document.getElementById('pingValue').textContent = speedTest.ping + ' ms';
                    
                    this.updateSpeedStatus('download', speedTest.download);
                    this.updateSpeedStatus('upload', speedTest.upload);
                    this.updatePingStatus(speedTest.ping);
                    
                    this.speedData.download.push(speedTest.download);
                    this.speedData.upload.push(speedTest.upload);
                    this.speedData.ping.push(speedTest.ping);
                    
                    this.log('Speed test complete: Download ' + speedTest.download + ' Mbps, Upload ' + speedTest.upload + ' Mbps, Ping ' + speedTest.ping + ' ms');
                    
                } catch (error) {
                    this.log('Speed test failed: ' + error.message);
                }
            }

            async performSpeedTest() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const download = (Math.random() * 100 + 50).toFixed(2);
                        const upload = (Math.random() * 50 + 10).toFixed(2);
                        const ping = (Math.random() * 50 + 10).toFixed(2);
                        
                        resolve({ download, upload, ping });
                    }, 3000);
                });
            }

            detectConnectionType() {
                const localSpeed = this.speedData.local[this.speedData.local.length - 1] || 0;
                
                let connectionType, speedClass;
                
                if (localSpeed > 500) {
                    connectionType = "1000 Mbps (Gigabit Ethernet)";
                    speedClass = "gigabit";
                } else if (localSpeed > 50) {
                    connectionType = "100 Mbps (Fast Ethernet)";
                    speedClass = "fast-ethernet";
                } else {
                    connectionType = "10 Mbps (Ethernet)";
                    speedClass = "ethernet";
                }
                
                document.getElementById('connectionType').textContent = connectionType;
                document.getElementById('connectionType').className = 'connection-type ' + speedClass;
                
                this.log('Connection type detected: ' + connectionType);
                this.log('Current local speed: ' + localSpeed.toFixed(2) + ' Mbps');
            }

            updateSpeedStatus(type, speed) {
                const element = document.getElementById(type + 'Status');
                let status, color;
                
                if (type === 'download') {
                    if (speed > 50) {
                        status = 'Excellent';
                        color = '#4CAF50';
                    } else if (speed > 25) {
                        status = 'Good';
                        color = '#8BC34A';
                    } else if (speed > 10) {
                        status = 'Acceptable';
                        color = '#FFC107';
                    } else {
                        status = 'Poor';
                        color = '#F44336';
                    }
                } else {
                    if (speed > 20) {
                        status = 'Excellent';
                        color = '#4CAF50';
                    } else if (speed > 10) {
                        status = 'Good';
                        color = '#8BC34A';
                    } else if (speed > 5) {
                        status = 'Acceptable';
                        color = '#FFC107';
                    } else {
                        status = 'Poor';
                        color = '#F44336';
                    }
                }
                
                element.textContent = status;
                element.style.color = color;
            }

            updatePingStatus(ping) {
                const element = document.getElementById('pingStatus');
                let status, color;
                
                if (ping < 30) {
                    status = 'Excellent';
                    color = '#4CAF50';
                } else if (ping < 60) {
                    status = 'Good';
                    color = '#8BC34A';
                } else if (ping < 100) {
                    status = 'Acceptable';
                    color = '#FFC107';
                } else {
                    status = 'High';
                    color = '#F44336';
                }
                
                element.textContent = status;
                element.style.color = color;
            }

            updateCharts() {
                this.speedChart.update();
                
                const latestLocal = this.speedData.local[this.speedData.local.length - 1] || 0;
                const latestDownload = this.speedData.download[this.speedData.download.length - 1] || 0;
                const latestUpload = this.speedData.upload[this.speedData.upload.length - 1] || 0;
                
                this.comparisonChart.data.datasets[0].data = [latestLocal, latestDownload, latestUpload];
                this.comparisonChart.update();
            }

            log(message) {
                const logElement = document.getElementById('log');
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = 'log-entry';
                logEntry.innerHTML = '<strong>[' + timestamp + ']</strong> ' + message;
                
                logElement.appendChild(logEntry);
                logElement.scrollTop = logElement.scrollHeight;
            }

            capitalizeFirstLetter(string) {
                return string.charAt(0).toUpperCase() + string.slice(1);
            }
        }

        // Initialize application when page loads
        document.addEventListener('DOMContentLoaded', function() {
            new NetworkMonitor();
        });
    </script>
</body>
</html>
